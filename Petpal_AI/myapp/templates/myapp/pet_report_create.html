{% load static %}
{% load tailwind_tags %}
<!doctype html>
<html lang="th"> <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ page_title }} — Petpal AI</title> {% tailwind_css %} 
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    html, body { font-family: "Noto Sans Thai", system_ui; }
    .form-input {
      @apply mt-1 w-full rounded-xl border border-gray-300 px-3 py-2 shadow-sm focus:border-orange-500 focus:ring-orange-500;
    }
  </style>
</head>
<body class="bg-white text-neutral-900">

  {% include "myapp/partials/navbar.html" %}

  <main class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-10">

    <header class="mb-8 space-y-4">
      <div class="flex justify-between items-center">
        <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight">{{ page_title }}</h1>
        <button onclick="history.back()" class="rounded-md shadow-sm text-sm font-medium px-4 py-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">
          Back
        </button>
      </div>
    </header>

    <form method="POST" enctype="multipart/form-data" class="space-y-6">
      {% csrf_token %}
      
      {% if form.errors %}
      <div class="rounded-md bg-red-50 p-4">
        </div>
      {% endif %}

      <div>
        <label class="text-lg font-semibold">{{ form.image.label }}</label>
        <div class="mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10"
             x-data="{imagePreview: null}">
          <div class="text-center" x-show="!imagePreview">
            <svg class="mx-auto h-12 w-12 text-gray-300" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M1.5 6a2.25 2.25 0 012.25-2.25h16.5A2.25 2.25 0 0122.5 6v12a2.25 2.25 0 01-2.25 2.25H3.75A2.25 2.25 0 011.5 18V6zM3 16.06l4.47-4.47a.75.75 0 011.06 0l3.97 3.97 3.97-3.97a.75.75 0 011.06 0l4.47 4.47V6H3v10.06z" clip-rule="evenodd" /></svg>
            <div class="mt-4 flex text-sm leading-6 text-gray-600">
              <label for="{{ form.image.id_for_label }}" class="relative cursor-pointer rounded-md bg-white font-semibold text-orange-600 hover:text-orange-500">
                <span>อัปโหลดไฟล์</span>
                <input id="{{ form.image.id_for_label }}" name="{{ form.image.name }}" type="file" class="sr-only"
                       @change="imagePreview = $event.target.files[0] ? URL.createObjectURL($event.target.files[0]) : null">
              </label>
              <p class="pl-1">หรือลากมาวาง</p>
            </div>
            <p class="text-xs leading-5 text-gray-600">PNG, JPG, GIF (สูงสุด 10MB)</p>
          </div>
          <div x-show="imagePreview" class="relative">
            <img :src="imagePreview" alt="Preview" class="max-h-64 rounded-md">
            <button @click="imagePreview = null; $event.target.closest('form').image.value = null;" type="button"
                    class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-6 w-6 flex items-center justify-center">
              &times;
            </button>
          </div>
        </div>
      </div>

      <div class="space-y-4 rounded-lg border border-gray-200 p-4">
        <h3 class="text-lg font-semibold">ข้อมูลสัตว์เลี้ยง</h3>
        <div>
          <label for="{{ form.pet_name.id_for_label }}" class="block font-medium">{{ form.pet_name.label }} :</label>
          {{ form.pet_name }}
        </div>
        <div>
          <label for="{{ form.animal.id_for_label }}" class="block font-medium">{{ form.animal.label }} : (เลือกประเภทก่อน)</label>
          {{ form.animal }}
        </div>
        <div>
          <label for="{{ form.gender.id_for_label }}" class="block font-medium">{{ form.gender.label }} :</label>
          {{ form.gender }}
        </div>
        <div>
          <label for="{{ form.birth_date.id_for_label }}" class="block font-medium">{{ form.birth_date.label }} :</label>
          {{ form.birth_date }}
        </div>
        <div>
          <label for="{{ form.description.id_for_label }}" class="block font-medium">{{ form.description.label }} :</label>
          {{ form.description }}
        </div>
      </div>
      
      {% if post_type == 'LOST' %}
      <div class="space-y-4 rounded-lg border border-gray-200 p-4">
        <h3 class="text-lg font-semibold">ข้อมูลการหาย</h3>
        <div>
          <label for="{{ form.lost_date.id_for_label }}" class="block font-medium">{{ form.lost_date.label }} :</label>
          {{ form.lost_date }}
        </div>
        <div>
          <label for="{{ form.lost_location.id_for_label }}" class="block font-medium">{{ form.lost_location.label }} :</label>
          {{ form.lost_location }}
        </div>
      </div>
      {% endif %}

      <div class="space-y-4 rounded-lg border border-gray-200 p-4">
        <h3 class="text-lg font-semibold">ข้อมูลติดต่อ</h3>
        <div>
          <label for="{{ form.contact_phone.id_for_label }}" class="block font-medium">{{ form.contact_phone.label }} :</label>
          {{ form.contact_phone }}
        </div>
        <div>
          <label for="{{ form.contact_social.id_for_label }}" class="block font-medium">{{ form.contact_social.label }} :</label>
          {{ form.contact_social }}
        </div>
      </div>

      <div class="flex justify-end pt-5">
        <button type="submit"
                class="rounded-full bg-green-400 px-10 py-3 text-lg font-semibold text-green-900 shadow-sm hover:bg-green-500">
          Confirm
        </button>
      </div>

    </form>
  </main>

  </body>
</html>